name: 'Example composite GitHub action'
description: 'Example composite GitHub action'
author: hello@cloudposse.com
branding:
  icon: 'file'
  color: 'white'
inputs:
  organization:
    required: true
    description: "Spacelift organization"
  api_key_id:
    required: true
    description: "Spacelift API key id"
  api_key_secret:
    required: true
    description: "Spacelift API key secret"
  stack:
    required: true
    description: "Spacelift stack"
    default: "true"
  github_token:
    required: true
    description: "GitHub Token"
outputs:
  result1:
    description: "Output result placeholder"
    value: "${{ inputs.param1 }}"
runs:
  using: "composite"
  steps:
    - name: Install spacectl
      uses: spacelift-io/setup-spacectl@main
      env:
        GITHUB_TOKEN: ${{ inputs.github_token }}
    - id: context
      shell: bash
      env:
        SPACELIFT_API_KEY_ENDPOINT: https://${{ inputs.organization }}.app.spacelift.io
        SPACELIFT_API_KEY_ID: ${{ inputs.api_key_id  }}
        SPACELIFT_API_KEY_SECRET: ${{ inputs.api_key_secret  }}
      run: |
        spacectl --help
        spacectl stack --help
        spacectl stack deploy --help
        spacectl stack output --help
        spacectl stack deploy --id=${{ inputs.stack }} --tail
